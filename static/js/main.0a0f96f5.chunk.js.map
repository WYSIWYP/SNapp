{"version":3,"sources":["contexts/Dialog.tsx","parser/Types.tsx","components/Frame.tsx","contexts/CurrentFile.tsx","pages/Convert.tsx","pages/NotFound.tsx","contexts/Global.tsx","components/global/Dialog.tsx","components/global/Global.tsx","pages/Menu.tsx","Router.tsx","serviceWorker.ts","index.tsx","util/Dialog.tsx","contexts/Preferences.tsx","components/SNView.tsx","util/Util.tsx","parser/MusicXML.tsx","images/dropDown.svg","images/upload.svg"],"names":["initialState","shown","DialogContext","createContext","undefined","DialogStateProvider","_ref","children","reducer","useRef","state","action","type","data","val","_useReducer","useReducer","current","_useReducer2","Object","_Users_ahharvey_Documents_GitHub_SNapp_client_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","dispatch","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","Provider","value","useDialogState","useContext","Tie","__webpack_require__","d","__webpack_exports__","styles","appContainer","overflow","header","paddingTop","fontStyle","fontWeight","fontSize","alignItems","textAlign","letterSpacing","left","top","height","transform","backgroundColor","minWidth","position","page","sideBar","overflowY","overflowX","right","Frame","sideMenu","showSideMenu","react_default","style","id","objectSpread","className","concat","CurrentFileContext","CurrentFileStateProvider","slicedToArray","useCurrentFileState","leftSide","float","width","svg","marginRight","display","color","marginTop","marginLeft","cursor","subHeader","SNView","sideBarTop","justifyContent","borderBottom","opacity","zIndex","sideBarTopOptions","whiteSpace","fileInput","padding","sideBarContent","line","margin","name","select","backgroundPosition","backgroundRepeat","backgroundImage","dropDown","paddingLeft","border","borderRadius","WebkitAppearance","hidden","Convert","_useState","useState","_useState2","show","setShow","_usePreferencesState","usePreferencesState","_usePreferencesState2","preferences","setPreferences","_useCurrentFileState","_useCurrentFileState2","currentFile","setCurrentFile","_useState3","_useState4","showPreferencesButton","setShowPreferencesButton","useEffect","timeout","setTimeout","clearTimeout","asyncToGenerator","regenerator_default","mark","_callee","file_name","wrap","_context","prev","next","localStorage","getItem","JSON","parse","filter","x","e","console","log","navigate","stop","sidebar","title","onClick","file","Blob","stringify","saveAs","exportFile","accept","onChange","reader","FileReader","onload","parsed","target","result","error","readAsText","files","importFile","onSubmit","noteDurationColor","colorPreferenceOptions","map","key","noteSymbolColor","staffScale","scalePreferenceOptions","noteScale","horizontalSpacing","spacingPreferenceOptions","verticalSpacing","naturalNoteShape","noteHeadPreferenceOptions","sharpNoteShape","flatNoteShape","measuresPerRow","measuresPerRowOptions","accidentalType","accidentalTypeOptions","components_Frame","xmlns","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","points","document","getElementById","canvas","getElementsByClassName","pdf","jsPDF","rows","nextRowY","i","length","row","_split$map","getElementsByTagName","getAttribute","split","parseInt","_split$map2","w","h","canvasRowHeight","Math","ceil","pdfRowHeight","addPage","ctx","getContext","fillStyle","fillRect","canvg","innerHTML","ignoreClear","addImage","save","openPDF","padding-right","Fragment","cx","cy","r","xml","forcedWidth","body","NotFound","GlobalStateProvider","PreferencesStateProvider","forEach","bg","frame","lineHeight","userSelect","headerRight","maxHeight","buttons","bottom","Dialog","_useDialogState","dialog","active","startX","startY","mouseX","mouseY","y","drag","setDrag","onMouseMove","clientX","clientY","onMouseUp","onMouseLeave","onMouseDown","contents","Global","components","X","container","flexDirection","item","flex","recentFiles","maxWidth","recentFilesInner","paddingRight","recentFilesItem","textOverflow","recentFilesSeparator","recentFilesItemInner","link","icon","Menu","setRecentFiles","setDialogState","showError","recent","onUpload","fileName","Array","from","floor","random","toString","join","setItem","newRecentFiles","splice","unshift","date","Date","getTime","react","loadFile","getMonth","getDate","getFullYear","src","alt","replace","failedReads","fail","reader1","Error","zip","details","parser","detailsDOM","nodes","musicXMLPath","musicXMLData","JSZip","loadAsync","sent","async","DOMParser","parseFromString","MusicXML","parseScore","measures","t0","readAsArrayBuffer","reader2","uploadFile","Router","contexts_Global","es","pages_Menu","path","pages_Convert","pages_NotFound","global_Global","Boolean","window","location","hostname","match","ReactDOM","render","src_Router","navigator","serviceWorker","ready","then","registration","unregister","close","showMessage","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","buttonText","buttonAction","space","paddingBottom","colorPreferenceStyles","black","grey","red","orange","yellow","green","blue","purple","keys","PreferencesContext","_Users_ahharvey_Documents_GitHub_SNapp_client_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","react__WEBPACK_IMPORTED_MODULE_2___default","Accidental","ref","_Users_ahharvey_Documents_GitHub_SNapp_client_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__","setWidth","score","setScore","_useDialogState2","dialogState","setImmediate","showErrorRef","callback","newWidth","getBoundingClientRect","addEventListener","removeEventListener","noteSymbolSize","small","medium","large","rowPadding","narrow","moderate","wide","horizontalPadding","staffLabelSpace","scoreWidth","beatWidth","tracks","timeSignatures","beats","keyFifths","keySignatures","fifths","octaveLines","number","accidentalMap","noteMap","getNoteAccidental","note","Sharp","Flat","Natural","getNoteLine","movementTitle","work","workTitle","author","credits","creditWords","credit","words","abs","minNote","maxNote","track","measure","min","midi","max","minLine","maxLine","rowHeight","beatsPerMeasure","measureWidth","measureNumber","reduce","accum","rowNumber","_getCurrentSignatures","_Users_ahharvey_Documents_GitHub_SNapp_client_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","reverse","currentTime","find","timeSignature","currentKey","keySignature","getCurrentSignatures","measureSVG","push","measureLabelSpace","j","octaveLine","lineY","textAnchor","dominantBaseline","tickX","tickSize","noteHeadSVG","noteTailSVG","idx","noteHead","tieStart","attributes","ties","includes","Start","tieStop","Stop","noteSpansRow","noteTail","noteTimeToPos","noteTime","boxes","_noteTimeToPos","time","xStart","yStart","xEnd","duration","roundingSpace","radiusStart","radiusEnd","pointedEnd","fillOpacity","accidental","_noteTimeToPos3","triHeight","sqrt","crossCircleWidth","triangleUp","triangleDown","hollowCircle","circle","crossCircle","x1","y1","x2","y2","noteShapes","▲","▼","○","●","◼","□","⨂","svgRows","range","alignmentBaseline","res","_Types__WEBPACK_IMPORTED_MODULE_0__","pitchToMidi","pitch","step","c","f","g","b","toLowerCase","octave","alter","round","currentBeatType","parts","partName","divisions","progress","part","notes","divisionsToNoteLength","entry","_class","chord","rest","entryTies","tie","times","beatTypes","newMeasures","_","index","start","slice","currentMeasureLength","lastNote","measureLength","module","exports","p"],"mappings":"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","file":"static/js/main.0a0f96f5.chunk.js","sourcesContent":["import React, {createContext, useContext, useReducer, useRef} from 'react';\n\nexport type state = {\n    shown: boolean,\n    data?: {\n        title: string,\n        contents: any,\n        width: number,\n        height: number,\n    }\n};\nexport type action = {\n    type: 'open', val: state['data'],\n} | {\n    type: 'close',\n};\n\nlet initialState: state = {\n    shown: false,\n};\n\nexport const DialogContext = createContext(undefined! as [state, React.Dispatch<action>]);\nexport const DialogStateProvider: React.FC<{}> = ({children}) => {\n    //we need to use a ref here to ensure that the same reducer is always used\n    let reducer = useRef((state: state, action: action): state => {\n        switch (action.type) {\n            case 'open':\n                return {\n                    shown: true,\n                    data: action.val,\n                };\n            case 'close':\n                return {shown: false};\n        }\n    });\n    let [state, dispatch] = useReducer(reducer.current, initialState);\n    return (\n        <DialogContext.Provider value={[state, dispatch]}>\n            {children}\n        </DialogContext.Provider>\n    );\n};\nexport const useDialogState = () => useContext(DialogContext);\n","/**\n * This file contains types shared across all parsers.\n */\n\nexport enum Tie {\n    Start = \"START\", \n    Stop = \"STOP\",\n}\n\nexport type basicNote = {\n    time: number,\n    duration: number,\n    midi: number,\n    attributes: {\n        ties: Tie[], // TODO: consider making this optional\n        // other attributes like slurs and dynamics can go here\n    }\n};\n\nexport type measure = basicNote[];\n\nexport type TimeSignature = {\n    measure: number,\n    beats: number,\n    beatTypes: number,\n};\n\nexport type KeySignature = {\n    measure: number,\n    fifths: number\n}\n\nexport type Tracks = {\n    measures: measure[],\n    timeSignatures: TimeSignature[],\n    keySignatures: KeySignature[]\n}[]\n\nexport type Score = {\n    tracks: Tracks,\n}\n","import React, { CSSProperties } from \"react\";\n\ntype Props = {\n  header: string;\n  fontSize?: number;\n  sideMenu?: React.ReactNode;\n  showSideMenu?: boolean;\n};\n\nconst Frame: React.FC<Props> = ({\n  header,\n  fontSize,\n  sideMenu,\n  showSideMenu,\n  children\n}) => {\n  return (\n    <div style={styles.appContainer}>\n      <div id=\"header\" style={{ ...styles.header, fontSize: fontSize || 45 }}>\n        {header}\n        {/* <div style={styles.headerLeft}>\n                    {headerLeft}\n                </div>\n                <div style={styles.headerRight}>\n                    {headerRight}\n                </div> */}\n      </div>\n\n      <div style={styles.page}>{children}</div>\n      <div className={`animated ${showSideMenu?'open':'close'}`}\n        style={{...styles.sideBar}}>\n            {sideMenu}\n      </div>\n    </div>\n  );\n};\n\nconst styleMap = {\n  appContainer: {\n    overflow: \"hidden\"\n  },\n  header: {\n    paddingTop: \"8px\",\n    fontStyle: \"normal\",\n    fontWeight: \"normal\",\n    fontSize: \"42px\",\n    alignItems: \"center\",\n    textAlign: \"center\",\n    letterSpacing: \"0.15em\",\n    left: \"50%\",\n    top: \"0px\",\n    height: \"80px\",\n    transform: \"translate(-50%,0px)\",\n    backgroundColor: \"#31B7D6\",\n    minWidth: \"600px\",\n    position: \"absolute\"\n  },\n  page: {\n    top: \"80px\",\n    height: \"calc(100% - 80px)\",\n    overflow: \"auto\"\n  },\n  sideBar: {\n    overflowY: 'scroll',\n    overflowX: 'hidden',\n    backgroundColor: \"rgba(0,0,0,0.7)\",\n    top: \"80px\",\n    height: \"calc(100% - 80px)\",\n    left: \"auto\",\n    right: \"0px\"\n  }\n} as const;\nconst styles: Record<keyof typeof styleMap, CSSProperties> = styleMap;\n\nexport default Frame;\n","import React, {createContext, useContext, useReducer, useRef} from 'react';\nimport MusicXML from 'musicxml-interfaces';\n\nexport type state = {\n    id?: string,\n    file_name?: string,\n    data?: MusicXML.ScoreTimewise\n};\nexport type action = {\n    type: 'set', val: state,\n};\n\nlet initialState: state = {};\n\nexport const CurrentFileContext = createContext(undefined! as [state, React.Dispatch<action>]);\nexport const CurrentFileStateProvider: React.FC<{}> = ({children}) => {\n    //we need to use a ref here to ensure that the same reducer is always used\n    let reducer = useRef((state: state, action: action): state => {\n        switch (action.type) {\n            case 'set':\n                return action.val;\n        }\n    });\n    let [state, dispatch] = useReducer(reducer.current, initialState);\n    return (\n        <CurrentFileContext.Provider value={[state, dispatch]}>\n            {children}\n        </CurrentFileContext.Provider>\n    );\n};\nexport const useCurrentFileState = () => useContext(CurrentFileContext);\n","import React, {useEffect, useState, CSSProperties} from 'react';\nimport {RouteComponentProps, navigate} from \"@reach/router\";\nimport SNView from '../components/SNView';\nimport Frame from '../components/Frame';\nimport {saveAs} from 'file-saver';\nimport dropDown from '../images/dropDown.svg'\nimport {useCurrentFileState} from '../contexts/CurrentFile';\nimport {\n    usePreferencesState, colorPreferenceOptions, scalePreferenceOptions, \n    spacingPreferenceOptions, noteHeadPreferenceOptions, measuresPerRowOptions, accidentalTypeOptions\n} from '../contexts/Preferences';\nimport jsPDF from 'jspdf';\nimport canvg from 'canvg';\n// import {useDialogState} from '../contexts/Dialog';\n// import * as Dialog from '../util/Dialog';\n\ntype Props = {} & RouteComponentProps;\n\nconst Convert: React.FC<Props> = () => {\n\n    let [show, setShow] = useState(false);\n\n    let [preferences, setPreferences] = usePreferencesState();\n    let [currentFile, setCurrentFile] = useCurrentFileState();\n    // let [, setDialogState] = useDialogState();\n\n    let [showPreferencesButton, setShowPreferencesButton] = useState(true);\n\n    // let showError = (error: string)=>{\n    //     setDialogState(Dialog.showMessage('An Error Occurred',error,'Close',()=>{\n    //         setDialogState(Dialog.close());\n    //     }));\n    // }\n\n    useEffect(() => {\n        if (show) {\n            setShowPreferencesButton(false);\n            return () => {};\n        } else {\n            let timeout = setTimeout(() => {\n                setShowPreferencesButton(true);\n            }, 1000);\n            return () => {\n                clearTimeout(timeout);\n            }\n        }\n    }, [show])\n\n    useEffect(() => {\n        (async () => {\n            // If the current file is not in the context,\n            if (currentFile.id === undefined) {\n                try {\n                    // Load the current file data from localStorage\n                    let id = localStorage.getItem('current_file')!;\n                    let file_name = JSON.parse(localStorage.getItem('recent_files')!).filter((x: any) => x.id === id)[0].file_name;\n                    let data = JSON.parse(localStorage.getItem(id)!);\n                    setCurrentFile({type: 'set', val: {id, file_name, data}});\n                } catch (e) {\n                    console.log(e);\n                    navigate('..');\n                }\n            }\n        })();\n    }, [currentFile.id, setCurrentFile]);\n\n    let openPDF = () => {\n        try {\n\n            let margin = 5;\n            let padding = 5;\n\n            let hidden = document.getElementById('hidden-pdf-generation') as HTMLDivElement;\n            let canvas = hidden.getElementsByClassName('canvas')[0] as HTMLCanvasElement;\n            \n            let pdf = new jsPDF(); //210 x 297 mm (A4 paper dimensions)\n            let width = 210;\n            let height = 297;\n\n            // should change with preferences\n            margin = width*margin/100;\n            padding = width*padding/100;\n\n\n            let rows = hidden.getElementsByClassName('snview-row');\n            \n            let nextRowY = margin;\n            for(let i = 0; i < rows.length; i++) {\n                let row = rows[i];\n\n                let [,,w,h] = row.getElementsByTagName('svg')[0].getAttribute('viewBox')!.split(' ').map(x=>parseInt(x));\n                let canvasRowHeight = Math.ceil(1000*h/w);\n                let pdfRowHeight = Math.ceil((width-margin*2)*h/w);\n\n                if(nextRowY+pdfRowHeight > height-margin){\n                    pdf.addPage();\n                    nextRowY = margin;\n                }\n\n                canvas.height = canvasRowHeight;\n                let ctx = canvas.getContext(\"2d\")!;\n                ctx.fillStyle = \"white\";\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\n                ctx.fillStyle = \"black\";\n                canvg(canvas,row.innerHTML,{ignoreClear: true});\n                pdf.addImage(canvas, 'JPEG', margin, nextRowY, width-margin*2, pdfRowHeight);\n\n                nextRowY += pdfRowHeight+padding;\n            }\n            \n            \n            \n            // pdf.rect(0,0,200,287,'F');\n            // pdf.addPage();\n            // pdf.rect(0,10,200,287,'F');\n\n            //(pdf as any).addSvgAsImage(document.getElementById('snview')!.innerHTML, 0, 0, 1000, 1000);\n            pdf.save(`${currentFile.file_name || 'WYSIWYP'}.pdf`);\n        } catch (e) {\n            console.error(e);\n        }\n    };\n    let exportFile = () => {\n        var file = new Blob([JSON.stringify(preferences, null, 4)], {type: 'text/plain'});\n        saveAs(file, 'preferences.snapp');\n    };\n    let importFile = (e: React.ChangeEvent<HTMLInputElement>) => {\n        try {\n            let reader = new FileReader();\n            reader.onload = function (e) {\n                try {\n                    let parsed = JSON.parse((e.target as any).result);\n                    setPreferences({type: 'set', val: parsed});\n                } catch (e) {\n                    console.error(e);\n                }\n            };\n            reader.readAsText((e.target as any).files[0]);\n        } catch (e) {\n            console.error(e);\n        }\n        e.target.value = \"\";\n    };\n    let sidebar = (<div style={styles.sideBar}>\n        <div style={styles.sideBarTop}>\n            <div id=\"export\" title=\"Click to export\" style={styles.sideBarTopOptions} onClick={() => {exportFile();}}>\n                Export\n            </div>\n            <div id=\"import\" style={styles.sideBarTopOptions}>\n                Import\n                <input style={styles.fileInput} type=\"file\" title=\"Click to import\" accept=\".snapp\" onChange={(e) => {importFile(e);}}></input>\n            </div>\n            <div id=\"close\" style={styles.sideBarTopOptions} onClick={() => {setShow(false);}}>\n                Close X\n            </div>\n        </div>\n        <form onSubmit={() => {setShow(false);}} >\n            <label>\n                <div style={styles.sideBarContent}>\n                    <div style={styles.line}>\n                        <div style={styles.name}>Note Duration Color</div>\n                        <select style={styles.select} value={preferences.noteDurationColor} onChange={\n                            (e) => {setPreferences({type: 'set', val: {noteDurationColor: e.target.value as any}});}\n                        }>{colorPreferenceOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n                    <div style={styles.line}>\n                        <div style={styles.name}>Note Symbol Color</div>\n                        <select style={styles.select} value={preferences.noteSymbolColor} onChange={\n                            (e) => {setPreferences({type: 'set', val: {noteSymbolColor: e.target.value as any}});}\n                        }>{colorPreferenceOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n\n                    <div style={styles.line}>\n                        <div style={styles.name}>Staff Scale</div>\n                        {/* deleted value and onchange */}\n                        <select style={styles.select} value={preferences.staffScale} onChange={\n                            (e) => {setPreferences({type: 'set', val: {staffScale: e.target.value as any}});}\n                        }>{scalePreferenceOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n\n                    <div style={styles.line}>\n                        <div style={styles.name}>Note Scale</div>\n                        {/* deleted value and onchange */}\n                        <select style={styles.select} value={preferences.noteScale} onChange={\n                            (e) => {setPreferences({type: 'set', val: {noteScale: e.target.value as any}});}\n                        }>{scalePreferenceOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n\n                    <div style={styles.line}>\n                        <div style={styles.name}>Horizontal Spacing</div>\n                        {/* deleted value and onchange */}\n                        <select style={styles.select} value={preferences.horizontalSpacing} onChange={\n                            (e) => {setPreferences({type: 'set', val: {horizontalSpacing: e.target.value as any}});}\n                        }>{spacingPreferenceOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n\n                    <div style={styles.line}>\n                        <div style={styles.name}>Vertical Spacing</div>\n                        {/* deleted value and onchange */}\n                        <select style={styles.select} value={preferences.verticalSpacing} onChange={\n                            (e) => {setPreferences({type: 'set', val: {verticalSpacing: e.target.value as any}});}\n                        }>{spacingPreferenceOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n\n                    <div style={styles.line}>\n                        <div style={styles.name}>Natural Note Shape</div>\n                        {/* deleted value and onchange */}\n                        <select style={styles.select} value={preferences.naturalNoteShape} onChange={\n                            (e) => {setPreferences({type: 'set', val: {naturalNoteShape: e.target.value as any}});}\n                        }>{noteHeadPreferenceOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n\n                    <div style={styles.line}>\n                        <div style={styles.name}>Sharp Note Shape</div>\n                        {/* deleted value and onchange */}\n                        <select style={styles.select} value={preferences.sharpNoteShape} onChange={\n                            (e) => {setPreferences({type: 'set', val: {sharpNoteShape: e.target.value as any}});}\n                        }>{noteHeadPreferenceOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n\n                    <div style={styles.line}>\n                        <div style={styles.name}>Flat Note Shape</div>\n                        {/* deleted value and onchange */}\n                        <select style={styles.select} value={preferences.flatNoteShape} onChange={\n                            (e) => {setPreferences({type: 'set', val: {flatNoteShape: e.target.value as any}});}\n                        }>{noteHeadPreferenceOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n\n                    <div style={styles.line}>\n                        <div style={styles.name}>Measures per Row</div>\n                        <select style={styles.select} value={preferences.measuresPerRow} onChange={\n                            (e) => {setPreferences({type: 'set', val: {measuresPerRow: e.target.value as any}});}\n                        }>{measuresPerRowOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n\n                    <div style={styles.line}>\n                        <div style={styles.name}>Accidental Type</div>\n                        <select style={styles.select} value={preferences.accidentalType} onChange={\n                            (e) => {setPreferences({type: 'set', val: {accidentalType: e.target.value as any}});}\n                        }>{accidentalTypeOptions.map(x => <option key={x}>{x}</option>)}</select>\n                    </div>\n                </div>\n            </label>\n        </form>\n    </div>)\n\n    return (\n        <Frame header=\"SNapp\" showSideMenu={show} sideMenu={sidebar}>\n            <div style={styles.subHeader}>\n\n                <div id=\"home\" style={styles.left} onClick={() => {navigate('/');}}>\n                    <svg style={styles.svg} xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\"></path><polyline points=\"9 22 9 12 15 12 15 22\"></polyline></svg>\n                    Home\n                </div>\n                <div style={styles.left} onClick={() => {openPDF();}}>\n                    <svg style={styles.svg} xmlns=\"http://www.w3.org/2000/svg\" padding-right=\"5px\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><path d=\"M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z\"></path><polyline points=\"13 2 13 9 20 9\"></polyline></svg>\n                    Save as PDF\n                </div>\n\n                <div id=\"preference\" style={styles.right} onClick={() => {setShow(true);}} >\n\n                    {!showPreferencesButton ? <></> : <><svg style={styles.svg} xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"></path></svg>Preferences</>}\n\n                </div>\n\n            </div>\n            <div style={styles.SNView}>\n                {currentFile.data === undefined ? null : <SNView xml={currentFile.data} />}\n            </div>\n            <div id=\"hidden-pdf-generation\" style={styles.hidden}>\n                <canvas className=\"canvas\" width={1000} height={1000}/>\n                {currentFile.data === undefined ? null : <SNView xml={currentFile.data} forcedWidth={1000} />}\n            </div>\n\n        </Frame>\n\n\n    );\n};\n\nconst styleMap = {\n    leftSide: {\n        float: 'left',\n        width: '80%',\n    },\n\n    svg: {\n        marginRight: '7px',\n    },\n    // snv:{\n    //     top: '200px',\n    // },\n\n    left: {\n        display: 'flex',\n        alignItems: 'center',\n        height: 'auto',\n        color: '#31B7D6',\n        marginTop: '15px',\n        marginLeft: '25px',\n        fontSize: '23px',\n        fontWeight: 'bold',\n        cursor: 'pointer',\n        position: 'relative',\n        float: 'left',\n        width: 'auto',\n    },\n    right: {\n        display: 'flex',\n        alignItems: 'center',\n        height: 'auto',\n        marginTop: '15px',\n        fontWeight: 'bold',\n        color: '#31B7D6',\n        fontSize: '23px',\n        marginRight: '25px',\n        position: 'relative',\n        float: 'right',\n        width: 'auto',\n        cursor: 'pointer',\n    },\n\n    subHeader: {\n        height: '65px',\n    },\n    SNView: {\n        top: '65px',\n        height: 'auto',\n    },\n    sideBar: {\n        color: 'white',\n        minWidth: '350px',\n    },\n    sideBarTop: {\n        position: 'sticky',\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n\n        borderBottom: '1px solid #BBBBBB',\n        height: '65px',\n        color: '#31B7D6',\n        fontSize: '23px',\n        fontWeight: 'bold',\n        width: 'auto',\n        backgroundColor: '#4c4c4c',\n        opacity: 1,\n        zIndex: 1,\n    },\n    sideBarTopOptions: {\n        position: 'relative',\n        width: '33%',\n        height: 'auto',\n        whiteSpace: 'nowrap',\n        textAlign: 'center',\n        cursor: 'pointer',\n    },\n    fileInput: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        width: '100%',\n        height: '100%',\n        cursor: 'pointer',\n        padding: '0px',\n        opacity: 0,\n    },\n    sideBarContent: {\n        zIndex: 0,\n        padding: '0 20px',\n        position: 'relative',\n        marginTop: '40px',\n    },\n    line: {\n        fontSize: '17px',\n        margin: '30px 0px',\n        justifyContent: 'center',\n        alignItems: 'baseline',\n        display: 'flex',\n        position: 'relative',\n        height: 'auto',\n\n    },\n    name: {\n        position: 'relative',\n        width: '60%',\n    },\n    select: {\n        fontSize: '17px',\n        height: '40px',\n        backgroundPosition: '95% center',\n        backgroundRepeat: 'no-repeat',\n        backgroundImage: `url(${dropDown})`,\n        backgroundColor: 'rgba(255,255,255,0.6)',\n        paddingLeft: '20px',\n        border: 'none',\n        borderRadius: '10px',\n        position: 'relative',\n        width: '40%',\n        textAlign: 'center',\n        WebkitAppearance: 'none',\n    },\n    hidden: {\n        width: '0px',\n        height: '0px',\n        overflow: 'hidden',\n        opacity: .01,\n    }\n\n} as const;\nconst styles: Record<keyof typeof styleMap, CSSProperties> = styleMap;\n\n\nexport default Convert;\n","import React, {CSSProperties} from 'react';\nimport {RouteComponentProps} from \"@reach/router\";\n\ntype Props = {} & RouteComponentProps;\n\nconst NotFound: React.FC<Props> = () => {\n    return (\n        <div style={styles.body}>\n            That page could not be found\n        </div>\n    );\n};\n\nconst styleMap = {\n    body: {\n        top: '50%',\n        height: 'auto',\n        transform: 'translate(0px,-50px)',\n        textAlign: 'center',\n        fontSize: '22px',\n    },\n} as const;\nconst styles: Record<keyof typeof styleMap,CSSProperties> = styleMap;\n\nexport default NotFound;\n","import React from 'react';\nimport {DialogStateProvider} from './Dialog';\nimport {CurrentFileStateProvider} from './CurrentFile';\nimport {PreferencesStateProvider} from './Preferences';\n\nconst GlobalStateProvider: React.FC<{}> = ({children}) => {\n    //we need to use a ref here to ensure that the same reducer is always used\n    let stateProviders = [DialogStateProvider, CurrentFileStateProvider, PreferencesStateProvider] as React.FunctionComponent[];\n    stateProviders.forEach(x=>{\n        children = x({children});\n    });\n    return <>{children}</>;\n};\nexport default GlobalStateProvider;\n","import React, {useEffect, useState, CSSProperties} from 'react';\nimport {useDialogState} from '../../contexts/Dialog';\n//import Button from '../Button';\n\ntype Props = {};\n\nconst Dialog: React.FC<Props> = () => {\n    \n    let [dialog,] = useDialogState();\n    let data = dialog.data!;\n\n    let [drag, setDrag] = useState({active: false, startX: 0, startY: 0, mouseX: 0, mouseY: 0, x: 0, y: 0});\n\n    useEffect(()=>{\n        if(drag.x !== 0 && drag.y !== 0 && !dialog.shown){\n            setDrag({...drag, x: 0, y: 0});\n        }\n    },[drag,dialog.shown]);\n\n    return (\n        !dialog.shown?null:<div\n            style={styles.bg}\n            onMouseMove={(e)=>{setDrag({...drag, mouseX: e.clientX, mouseY: e.clientY, ...(drag.active?{x: drag.mouseX-drag.startX, y: drag.mouseY-drag.startY}:{})});}}\n            onMouseUp={()=>{setDrag({...drag, active: false});}}\n            onMouseLeave={()=>{setDrag({...drag, active: false});}}\n        >\n            <div style={{\n                ...styles.frame,\n                top: `calc(50% + ${drag.y}px)`,\n                left: `calc(50% + ${drag.x}px)`,\n                width: `${data.width}px`,\n                height: `${data.height}px`,\n            }}>\n                <div style={{...styles.header, fontSize: 30 || 45}}\n                    onMouseDown={()=>{setDrag({...drag, active: true, startX: drag.mouseX-drag.x, startY: drag.mouseY-drag.y});}}\n                >\n                    {data.title}\n                    <div style={styles.headerRight}>\n                        {undefined || ''}\n                    </div>\n                </div>\n                <div style={styles.body}>\n                    {data.contents}\n                    {/*<div style={styles.buttons}><Button text={data.buttons[0].text} action={data.buttons[0].action || (()=>{dispatchDialog({type: 'close'})})} /></div>*/}\n                </div>\n            </div>\n        </div>\n    );\n};\n\nconst styleMap = {\n    bg: {\n        position: 'fixed',\n        backgroundColor: '#00000099',\n    },\n    frame: {\n        border: '2px solid #444',\n        overflow: 'hidden',\n        transform: 'translate(-50%,-50%)',\n        borderRadius: '10px',\n    },\n    header: {\n        height: '50px',\n        backgroundColor: '#ddd',\n        lineHeight: '50px',\n        textAlign: 'center',\n        userSelect: 'none',\n        borderBottom: '1px solid #444',\n    },\n    headerRight: {\n        left: 'auto',\n        right: '20px',\n        width: 'auto',\n        fontSize: '15px',\n    },\n    body: {\n        top: '50px',\n        backgroundColor: '#fff',\n        height: 'calc(100% - 50px)',\n    },\n    page: {\n        top: 'calc(50% - 40px)',\n        left: '50%',\n        height: 'auto',\n        width: '85%',\n        maxHeight: 'calc(100% - 120px)',\n        textAlign: 'center',\n        fontSize: '25px',\n        transform: 'translate(-50%, -50%)',\n        overflowY: 'auto',\n    },\n    buttons: {\n        top: 'auto',\n        bottom: '20px',\n        left: '50%',\n        width: '200px',\n        height: '60px',\n        transform: 'translate(-50%, 0px)',\n    },\n} as const;\nconst styles: Record<keyof typeof styleMap, CSSProperties> = styleMap;\n\nexport default Dialog;\n","import React from 'react';\nimport Dialog from './Dialog';\n\nconst Global: React.FC<{}> = ({children}) => {\n    //we need to use a ref here to ensure that the same reducer is always used\n    let components = [Dialog] as React.FunctionComponent[];\n    components.forEach(x=>{\n        children = x({children});\n    });\n    return <>{components.map((X,i)=><X key={i}></X>)}</>;\n};\nexport default Global;\n","import React, {CSSProperties, useState, useEffect, Fragment} from 'react';\nimport {RouteComponentProps, navigate} from \"@reach/router\";\nimport Frame from '../components/Frame';\nimport svg from '../images/upload.svg';\nimport MusicXML, {ScoreTimewise} from 'musicxml-interfaces';\nimport {useCurrentFileState} from '../contexts/CurrentFile';\nimport {useDialogState} from '../contexts/Dialog';\nimport * as Dialog from '../util/Dialog';\nimport JSZip from 'jszip';\n\ntype Props = {} & RouteComponentProps;\n\nconst Menu: React.FC<Props> = () => {\n    type recentFile = {\n        file_name: string,\n        date: number,\n        id: string,\n    };\n\n    let [recentFiles, setRecentFiles] = useState<recentFile[]>(undefined!);\n\n    let [, setDialogState] = useDialogState();\n    let [, setCurrentFile] = useCurrentFileState();\n\n    let showError = (error: string)=>{\n        setDialogState(Dialog.showMessage('An Error Occurred',error,'Close',()=>{\n            setDialogState(Dialog.close());\n        }));\n    }\n\n    useEffect(() => {\n        let recent: recentFile[] = null!;\n        try {\n            recent = JSON.parse(localStorage.getItem('recent_files')!);\n        } catch (e) {}\n        if (recent === null) {\n            recent = [];\n        }\n        setRecentFiles(recent);\n    }, []);\n\n    const loadFile = (x: recentFile) => {\n        try {\n            let parsed = JSON.parse(localStorage.getItem(x.id)!);\n\n            // Set this song as the current work in the global context\n            setCurrentFile({type: 'set', val: {id: x.id, file_name: x.file_name, data: parsed}});\n\n            try {\n                // Set this song as the current work in localStorage\n                localStorage.setItem('current_file', x.id);\n            } catch(e){\n                // Local storage may be disabled\n                console.error(e);\n            }\n\n            navigate('convert');\n        } catch (e) {\n            showError('An issue was encountered while loading the data for this file.');\n            console.error(e);\n        }\n    };\n    \n    const uploadFile = (e: React.ChangeEvent<HTMLInputElement>) => {\n        let fileName = (e.target as any).files[0].name.replace(/\\.(?:musicxml|mxl)$/i, '');\n        let failedReads = 0;\n        let fail = ()=>{\n            failedReads++;\n            if(failedReads === 2){ //both reads failed\n                showError('An issue was encountered while reading the selected file.');\n            }\n        }\n        try {\n            let reader1 = new FileReader();\n            reader1.onload = function () {\n                try {\n                    let data = reader1.result;\n                    if(data === null){\n                        throw new Error('Failed to read file - null');\n                    }\n                    //try to interpret this file as compressed\n                    \n                    (async ()=>{\n                        try {\n                            let zip = await JSZip.loadAsync(data);\n                            let details = await zip.file('META-INF/container.xml').async(\"text\");\n                            let parser = new DOMParser();\n                            let detailsDOM = parser.parseFromString(details, \"application/xml\");\n                            let nodes = detailsDOM.getElementsByTagName('rootfile');\n                            let musicXMLPath = nodes[0].getAttribute('full-path')!;\n                            for(let i = nodes.length-1; i >= 0; i--){\n                                if(nodes[i].getAttribute('media-type') === 'application/vnd.recordare.musicxml+xml'){\n                                    musicXMLPath = nodes[i].getAttribute('full-path')!;\n                                }\n                            }\n                            let musicXMLData = await zip.file(musicXMLPath).async(\"text\");\n                            let parsed = MusicXML.parseScore(musicXMLData);\n                            if(parsed.measures === undefined){\n                                throw new Error('Invalid MusicXML format');\n                            }\n                            onUpload(fileName,parsed);\n                        } catch(e){\n                            fail();\n                            console.error(e);\n                        }\n                    })();\n                } catch (e) {\n                    fail();\n                    console.error(e);\n                }\n            };\n            reader1.readAsArrayBuffer((e.target as any).files[0]);\n            let reader2 = new FileReader();\n            reader2.onload = function () {\n                try {\n                    let data = reader2.result;\n                    if(data === null){\n                        throw new Error('Failed to read file - null');\n                    }\n                    //try to interpret this file as uncompressed\n                    let parsed = MusicXML.parseScore(data as string);\n                    \n                    if(parsed.measures === undefined){\n                        throw new Error('Invalid MusicXML format');\n                    }\n                    console.log(parsed);\n                    \n                    onUpload(fileName,parsed);\n                } catch (e) {\n                    fail();\n                    console.error(e);\n                }\n            };\n            reader2.readAsText((e.target as any).files[0]);\n\n\n\n\n\n            // let reader = new FileReader();\n            // reader.onload = function () {\n            //     try {\n            //         let data = reader.result;\n            //         let parsed: ScoreTimewise;\n            //         if(data === null){\n            //             throw new Error('Failed to read file - null');\n            //         }\n            //         try {\n            //             //try to interpret this file as uncompressed\n            //             parsed = MusicXML.parseScore(data.toString());\n            //             console.log(data.toString());\n            //             console.log(parsed);\n            //         } catch(e){\n\n            //             throw new Error('...');\n            //         }\n\n            //         let id = `file_${Array.from({length: 16}, () => Math.floor(Math.random() * 16).toString(16)).join('')}`;\n\n            //         // Set this song as the current work in the global context\n            //         setCurrentFile({type: 'set', val: {id, file_name: fileName, data: parsed}});\n\n            //         // Fail silently if localStorage is disabled\n            //         try {\n                        \n            //             // Set this song as the current work in localStorage\n            //             localStorage.setItem(id, JSON.stringify(parsed));\n            //             localStorage.setItem('current_file', id);\n\n            //             // Add this song to the recent songs list\n            //             let newRecentFiles = recentFiles.map(x => x);\n\n            //             for (let i = 0; i < newRecentFiles.length; i++) {\n            //                 if (newRecentFiles[i]['file_name'] === fileName) {\n            //                     newRecentFiles.splice(i, 1);\n            //                 }\n            //             }\n\n            //             newRecentFiles.unshift({file_name: fileName, date: new Date().getTime(), id});\n            //             localStorage.setItem('recent_files', JSON.stringify(newRecentFiles));\n\n            //         } catch (e) {\n            //             console.error(e);\n            //         }\n\n            //         navigate('convert');\n            //     } catch (e) {\n            //         showError('An issue was encountered while reading the selected file.');\n            //         console.error(e);\n            //     }\n            // };\n            // reader.readAsArrayBuffer((e.target as any).files[0]);\n        } catch (e) {\n            showError('An issue was encountered while reading the selected file.');\n            console.error(e);\n        }\n    };\n\n    const onUpload = (fileName: string, parsed: ScoreTimewise)=>{\n        let id = `file_${Array.from({length: 16}, () => Math.floor(Math.random() * 16).toString(16)).join('')}`;\n\n        // Set this song as the current work in the global context\n        setCurrentFile({type: 'set', val: {id, file_name: fileName, data: parsed}});\n\n        // Fail silently if localStorage is disabled\n        try {\n            \n            // Set this song as the current work in localStorage\n            localStorage.setItem(id, JSON.stringify(parsed));\n            localStorage.setItem('current_file', id);\n\n            // Add this song to the recent songs list\n            let newRecentFiles = recentFiles.map(x => x);\n\n            for (let i = 0; i < newRecentFiles.length; i++) {\n                if (newRecentFiles[i]['file_name'] === fileName) {\n                    newRecentFiles.splice(i, 1);\n                }\n            }\n\n            newRecentFiles.unshift({file_name: fileName, date: new Date().getTime(), id});\n            localStorage.setItem('recent_files', JSON.stringify(newRecentFiles));\n\n        } catch (e) {\n            console.error(e);\n        }\n\n        navigate('convert');\n    }\n\n    return (\n        <Frame header=\"SNapp\">\n            {recentFiles === undefined ? null : <div style={styles.container}>\n                <div style={{...styles.item, flex: '1 0 auto'}} />\n                <div style={{...styles.item, maxWidth: '720px'}}>\n                    SNapp implements a simpler and more intuitive music notation so that\n                    musicians can spend less time learning music and more time playing it!\n                </div>\n                {recentFiles.length === 0 ? <>\n                    <div style={{...styles.item, flex: '.2 0 auto'}} />\n                    <div style={styles.item}>\n                        Try uploading a MusicXML file below\n                    </div>\n                    <div style={{...styles.item, flex: '.35 0 auto'}} />\n                </> : <>\n                        <div style={{...styles.item, flex: '.36 0 auto'}} />\n                        <div style={{...styles.item, fontSize: '28px', fontWeight: 'bolder'}}>Recent Files</div>\n                        <div style={{...styles.item, flex: '.08 0 auto'}} />\n                        <div style={{...styles.item, ...styles.recentFiles}}>\n                            <div style={{...styles.recentFilesInner}}>\n                                {recentFiles.map(x => <Fragment key={x.id}>\n                                    <div className=\"button-recent-file\" style={styles.recentFilesItem} onClick={() => {loadFile(x);}}>\n                                        <div style={{...styles.recentFilesItemInner, flex: '0 1 auto', fontWeight: 'bold'}}>\n                                            {x.file_name}\n                                        </div>\n                                        <div style={{...styles.recentFilesItemInner, width: '10px', flex: '1 1 auto'}} />\n                                        <div style={{...styles.recentFilesItemInner, flex: '0 100000 auto', fontSize: '22px'}}>\n                                            {(d => `${d.getMonth() + 1}/${d.getDate()}/${d.getFullYear()}`)(new Date(x.date))}\n                                        </div>\n                                    </div>\n                                    <div style={styles.recentFilesSeparator}></div>\n                                </Fragment>)}\n                            </div>\n                        </div>\n                        <div style={{...styles.item, flex: '.24 0 auto'}} />\n                    </>}\n                <div style={styles.item}>\n                    <span id=\"button-upload\" style={styles.link} onClick={() => {}}>\n                        <img src={svg} style={styles.icon} alt=\"\" />\n                        Upload MusicXML File\n                        <input style={styles.fileInput} type=\"file\" title=\"Click to upload\" accept=\".musicxml,.mxl\" onChange={(e) => {uploadFile(e);}}></input>\n                    </span>\n                </div>\n                <div style={{...styles.item, flex: '1 0 auto'}} />\n            </div>}\n        </Frame>\n    );\n};\n\nconst styleMap = {\n    container: {\n        display: 'flex',\n        flexDirection: 'column',\n        overflow: 'hidden',\n    },\n    item: {\n        position: 'initial',\n        top: 'auto',\n        left: 'auto',\n        height: 'auto',\n        marginLeft: '50%',\n        width: '70%',\n        transform: 'translate(-50%,0px)',\n        textAlign: 'center',\n        fontSize: '21px',\n        flex: '0 0 auto',\n    },\n    fileInput: {\n        position: 'absolute',\n        top: '0px',\n        left: 'calc(50% - 170px)',\n        width: '340px',\n        height: '100%',\n        cursor: 'pointer',\n        opacity: 0,\n    },\n    recentFiles: {\n        color: '#31B7D6',\n        maxWidth: '600px',\n        height: '250px',\n        borderRadius: '10px',\n        border: '2px solid #BBBBBB',\n        padding: '5px',\n        overflow: 'hidden',\n    },\n    recentFilesInner: {\n        position: 'relative',\n        paddingLeft: '15px',\n        paddingRight: '15px',\n        overflowX: 'hidden',\n        overflowY: 'auto',\n    },\n    recentFilesItem: {\n        display: 'flex',\n        width: 'calc(100% - 10px)',\n        marginTop: '20px',\n        marginLeft: '5px',\n        marginRight: '5px',\n        lineHeight: '40px',\n        fontSize: '24px',\n        position: 'relative',\n        height: '40px',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n        cursor: 'pointer',\n    },\n    recentFilesSeparator: {\n        position: 'relative',\n        height: '2px',\n        backgroundColor: '#DDDDDD',\n        borderRadius: '10px',\n    },\n    recentFilesItemInner: {\n        position: 'initial',\n        width: 'auto',\n        flex: '0 0 auto',\n        whiteSpace: 'nowrap',\n        overflow: 'hidden',\n        textOverflow: 'ellipsis',\n    },\n    link: {\n        color: '#31B7D6',\n        cursor: 'pointer',\n        fontSize: '28px',\n        fontWeight: 'bold',\n    },\n    icon: {\n        height: '1em',\n        width: '1em',\n        position: 'relative',\n        display: 'inline-flex',\n        top: '.125em',\n        marginRight: '.25em',\n    },\n} as const;\nconst styles: Record<keyof typeof styleMap, CSSProperties> = styleMap;\n\nexport default Menu;\n","import React from 'react';\nimport {Router as ReachRouter} from '@reach/router';\nimport Convert from './pages/Convert';\nimport NotFound from './pages/NotFound';\nimport GlobalStateProvider from './contexts/Global';\nimport Global from './components/global/Global';\nimport Menu from './pages/Menu';\n\nconst Router: React.FC = () => {\n    return (\n        <GlobalStateProvider>\n            <ReachRouter>\n                <Menu path=\"/\" />\n                <Convert path=\"/convert\" />\n                <NotFound path=\"/*\" />\n            </ReachRouter>\n            <Global />\n        </GlobalStateProvider>\n    );\n}\n\nexport default Router;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Router from './Router';\nimport * as serviceWorker from './serviceWorker';\nimport './index.css';\n\nReactDOM.render(<Router />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import React, {CSSProperties} from \"react\";\nimport {action as DialogAction} from '../contexts/Dialog';\n\nexport const close = ()=>{\n    return {type: 'close'} as DialogAction;\n}\n\nexport const showMessage = (title: string, body: any, buttonText: string, buttonAction: ()=>void): DialogAction =>{\n    return {type: 'open', val: {title, width: 400, height: 275, contents: <div style={styles.body}>\n        <div style={styles.space} />\n        <div style={styles.top}>\n            {body}\n        </div>\n        <div style={styles.space} />\n        <div style={styles.bottom}>\n            <span style={styles.link} onClick={buttonAction}>\n                {buttonText}\n            </span>\n        </div>\n    </div>}};\n}\n\nconst styleMap = {\n    body: {\n        display: 'flex',\n        flexDirection: 'column',\n    },\n    top: {\n        position: 'initial',\n        top: 'auto',\n        left: 'auto',\n        height: 'auto',\n        fontSize: '20px',\n        textAlign: 'center',\n        flex: '0 1 auto',\n        padding: '30px',\n        overflowX: 'hidden',\n        overflowY: 'auto',\n    },\n    bottom: {\n        position: 'initial',\n        top: 'auto',\n        left: 'auto',\n        height: 'auto',\n        textAlign: 'center',\n        flex: '0 0 auto',\n        paddingBottom: '20px',\n    },\n    space: {\n        position: 'initial',\n        top: 'auto',\n        left: 'auto',\n        height: 'auto',\n        flex: '1 0 auto',\n    },\n    link: {\n        color: '#31B7D6',\n        cursor: 'pointer',\n        fontSize: '28px',\n        fontWeight: 'bold',\n    }\n} as const;\nconst styles: Record<keyof typeof styleMap, CSSProperties> = styleMap;\n","import React, {createContext, useContext, useReducer, useRef} from \"react\";\n\nexport const colorPreferenceStyles = {\n    black: \"#000000\",\n    grey: \"#777777\",\n    red: \"#FF0000\",\n    orange: \"orange\",\n    yellow: \"#FFFF00\",\n    green: \"#00FF00\",\n    blue: \"#0000FF\",\n    purple: \"purple\"\n};\nexport const colorPreferenceOptions = Object.keys(\n    colorPreferenceStyles\n) as (keyof typeof colorPreferenceStyles)[];\nexport type colorPreferenceOption = (typeof colorPreferenceOptions)[number];\n\nexport const scalePreferenceOptions = ['small', 'medium', 'large'] as const;\nexport type scalePreferenceOption = (typeof scalePreferenceOptions)[number];\n\nexport const spacingPreferenceOptions = ['narrow', 'moderate', 'wide'] as const;\nexport type spacingPreferenceOption = (typeof spacingPreferenceOptions)[number];\n\nexport const noteHeadPreferenceOptions = [\"▲\", \"▼\", \"●\", \"○\", \"⨂\",\"◼\", \"□\"] as const;\nexport type noteHeadPreferenceOption = (typeof noteHeadPreferenceOptions)[number];\n\nexport const measuresPerRowOptions = [1, 2, 3, 4, 5, 6] as const; // TODO: Consider using a slider\nexport type measuresPerRowOption = (typeof measuresPerRowOptions)[number];\n\nexport const accidentalTypeOptions = ['auto', 'sharp', 'flat'] as const;\nexport type accidentalTypeOption = (typeof accidentalTypeOptions)[number];\n\nexport type state = {\n    noteDurationColor: colorPreferenceOption;\n    noteSymbolColor: colorPreferenceOption;\n    staffScale: scalePreferenceOption;\n    horizontalSpacing: spacingPreferenceOption;\n    verticalSpacing: spacingPreferenceOption;\n    noteScale: scalePreferenceOption;\n    naturalNoteShape: noteHeadPreferenceOption,\n    sharpNoteShape: noteHeadPreferenceOption;\n    flatNoteShape: noteHeadPreferenceOption;\n    measuresPerRow: measuresPerRowOption;\n    accidentalType: accidentalTypeOption\n};\nexport type action = {\n    type: \"set\";\n    val: Partial<state>;\n};\n\nlet initialState: state = {\n    noteDurationColor: \"grey\",\n    noteSymbolColor: \"black\",\n    staffScale: 'medium',\n    horizontalSpacing: 'moderate',\n    verticalSpacing: 'moderate',\n    noteScale: 'medium',\n    naturalNoteShape: '●',\n    sharpNoteShape: '▲',\n    flatNoteShape: '▼',\n    measuresPerRow: 4,\n    accidentalType: 'auto'\n};\n\nexport const PreferencesContext = createContext(undefined! as [\n    state,\n    React.Dispatch<action>\n]);\nexport const PreferencesStateProvider: React.FC<{}> = ({children}) => {\n    //we need to use a ref here to ensure that the same reducer is always used\n    let reducer = useRef(\n        (state: state, action: action): state => {\n            switch (action.type) {\n                case \"set\":\n                    return {...state, ...action.val};\n            }\n        }\n    );\n    let [state, dispatch] = useReducer(reducer.current, initialState);\n    return (\n        <PreferencesContext.Provider value={[state, dispatch]}>\n            {children}\n        </PreferencesContext.Provider>\n    );\n};\nexport const usePreferencesState = () => useContext(PreferencesContext);\n","import React, {useEffect, useState, useRef} from 'react';\nimport {range} from '../util/Util';\n// import {Note} from '@tonejs/midi/dist/Note';\nimport MusicXML from 'musicxml-interfaces';\nimport {parse} from '../parser/MusicXML'\nimport {basicNote, Score, Tie} from '../parser/Types'\nimport {colorPreferenceStyles, usePreferencesState, spacingPreferenceOption, scalePreferenceOption} from '../contexts/Preferences';\nimport {useDialogState} from '../contexts/Dialog';\nimport * as Dialog from '../util/Dialog';\nimport {navigate} from '@reach/router';\n\ntype Props = {\n    xml: MusicXML.ScoreTimewise,\n    forcedWidth?: number,\n};\n\nenum Accidental {\n    Flat = -1,\n    Natural = 0,\n    Sharp = 1\n}\n\nconst SNView: React.FC<Props> = ({xml, forcedWidth}) => {\n    console.log(xml)\n    const ref = useRef(null! as HTMLDivElement);\n    let [width, setWidth] = useState<number | undefined>(undefined);\n    let [score, setScore] = useState<Score | undefined>(undefined);\n    let [preferences,] = usePreferencesState();\n\n    let [dialogState, setDialogState] = useDialogState();\n\n    let showError = (error: string) => {\n        setDialogState(Dialog.showMessage('An Error Occurred', error, 'Close', () => {\n            navigate('/');\n            setImmediate(() => setDialogState(Dialog.close()));\n        }));\n    }\n    let showErrorRef = useRef(showError);\n\n    console.log('Score:', score);\n    useEffect(() => {\n        if (forcedWidth === undefined) {\n            let width: number = undefined!;\n            let callback = () => {\n                let newWidth = ref.current!.getBoundingClientRect().width;\n                if (width !== newWidth) {\n                    width = newWidth;\n                    setWidth(newWidth);\n                }\n            };\n            window.addEventListener(\"resize\", callback);\n            // let interval = setInterval(callback, 20);\n            callback();\n            return () => {\n                window.removeEventListener(\"resize\", callback);\n                // clearInterval(interval);\n            }\n        } else {\n            setWidth(forcedWidth);\n        }\n    }, [setWidth, forcedWidth]);\n\n    useEffect(() => {\n        // parse only when page loads or xml changes\n        try {\n            setScore(parse(xml));\n        } catch (e) {\n            showErrorRef.current('An issue was encountered while processing this file.');\n        }\n    }, [xml]);\n\n    if (score === undefined || width === undefined) { //skip first render when width is unknown or parsing is incomplete\n        return <div ref={ref}></div>;\n    }\n\n    try {\n        let devMode = false;\n\n        // fetch preference values\n        let {\n            noteDurationColor,\n            noteSymbolColor,\n            staffScale,\n            horizontalSpacing,\n            verticalSpacing,\n            noteScale,\n            naturalNoteShape,\n            sharpNoteShape,\n            flatNoteShape,\n            measuresPerRow,\n            accidentalType\n        } = preferences;\n\n        // Map preference strings to numeric values \n        let noteScaleMap: Record<scalePreferenceOption, number> = {\n            small: 15,\n            medium: 20,\n            large: 25\n        }\n        let staffScaleMap: Record<scalePreferenceOption, number> = {\n            small: 18,\n            medium: 25,\n            large: 32\n        };\n        let verticalSpacingMap: Record<spacingPreferenceOption, number> = {\n            narrow: 10,\n            moderate: 30,\n            wide: 50\n        };\n        let horizontalSpacingMap: Record<spacingPreferenceOption, number> = {\n            narrow: 20,\n            moderate: 40,\n            wide: 60\n        };\n\n        //general spacing\n        let noteSymbolSize = noteScaleMap[noteScale]; //width/height of note symbols\n        let strokeWidth = 2;\n        let tickSize = 7;\n\n        //vertical spacing\n        let verticalPadding = 30; //top/bottom padding\n        let rowPadding = verticalSpacingMap[verticalSpacing]; //space between rows\n        let measureLabelSpace = 15; //space for measure labels\n\n        //horizontal spacing\n        let horizontalPadding = horizontalSpacingMap[horizontalSpacing]; //left/right padding\n        let staffLabelSpace = staffScaleMap[staffScale]; //space for staff labels\n        let octaveLabelSpace = measureLabelSpace; //space for octave labels\n        // let tieExtensionSpace = measureLabelSpace;\n\n        // composite horizontal spacing\n        let scoreWidth = width - 2 * horizontalPadding - staffLabelSpace - octaveLabelSpace; // width of just the WYSIWYP score\n        let beatWidth = scoreWidth / score.tracks[0].timeSignatures[0].beats / measuresPerRow;\n\n        // get key signature\n        let keyFifths = score.tracks[0].keySignatures[0].fifths;\n\n        // let octaveGroups = [1, 1, 0, 0, 0, 1, 1]; //octaveGroups (C D E / F G A B)\n        // let staffLabels = ['𝒯','𝐵'];\n        let octaveLines = [\n            {color: 'red', number: true}, undefined, undefined, /* C, D, E */\n            {color: 'blue'}, undefined, undefined, undefined, /* F, G, A, B */\n        ];\n        let accidentalMap = [0, 1, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0].map(x => x === 1); // C, C#, D, D#, E, ...\n        let noteMap = [0, 0, 1, 1, 2, 3, 3, 4, 4, 5, 5, 6];\n\n        let getNoteAccidental = (note: number): Accidental => {\n            return accidentalMap[note % 12] ? (keyFifths >= 0 ? Accidental.Sharp : Accidental.Flat) : Accidental.Natural;\n        };\n\n        // We map C0 (midi note 12) to line 0.\n        let getNoteLine = (note: number) => {\n            let line = Math.floor(note / 12 - 1) * 7 + noteMap[note % 12];\n\n            // if note is flat, we need to bring it a line higher.\n            if (accidentalType === 'auto' && getNoteAccidental(note) < 0) line++;\n            else if (accidentalType === 'flat' && getNoteAccidental(note) !== 0) line++; // user overrided the accidental setting\n\n            return line;\n        };\n\n        //find the title and author\n        let title = '';\n        try {\n            title = xml.movementTitle;\n            title = xml.work.workTitle;\n        } catch(e){}\n\n        let author = '';\n        try {\n            let credits = xml.credits.filter(x=>x.creditWords !== undefined && x.creditWords.length > 0).map(x=>x.creditWords);\n            credits.forEach(credit=>{credit.forEach(words=>{\n                if(Math.abs(words.words.length-20)<Math.abs(author.length-20)){\n                    author = words.words;\n                }\n            })})\n        } catch(e){}\n\n\n        //calculate lowest and highest note\n        let minNote = 128, maxNote = -1;\n        score.tracks.forEach(track => track.measures.forEach(measure =>\n            measure.forEach(note => {\n                minNote = Math.min(minNote, note.midi);\n                maxNote = Math.max(maxNote, note.midi);\n            })\n        ));\n\n        //if there was an issue, abort\n        if (minNote >= 128 || minNote < 0 || maxNote >= 128 || maxNote < 0) {\n            console.log(minNote, maxNote);\n            throw new Error('An issue was detected while analyzing this work\\'s note range');\n        }\n\n        //calculate the height of each row (based upon low/high notes and oct groups)\n        let minLine = getNoteLine(minNote);\n        let maxLine = getNoteLine(maxNote);\n\n        // find the closest colored line for minNote and minLine\n        while (minLine % 7 !== 0 && minLine % 7 !== 3) minLine--;\n        while (maxLine % 7 !== 0 && maxLine % 7 !== 3) maxLine++;\n\n        // widen staff range if it is too small\n        if (Math.abs(maxLine - minLine) <= 1) {\n            maxLine += (maxLine % 7 === 0) ? 3 : 4;\n            minLine -= (minLine % 7 === 0) ? 4 : 3;\n        }\n\n        let rowHeight = (maxLine - minLine) * noteSymbolSize / 2; //not including measure labels\n\n        //calculate the number of beats per measure\n        let beatsPerMeasure = score.tracks[0].timeSignatures[0].beats;\n        let measureWidth = beatWidth * beatsPerMeasure;\n\n        //calculate tne number of measures per row\n        let availableMeasureSpace = width - horizontalPadding * 2 - staffLabelSpace - octaveLabelSpace;\n        // let measuresPerRow = Math.floor(availableMeasureSpace / measureWidth);\n        // if (measuresPerRow <= 0) {\n        //     throw new Error('Could not place a measure in the allowed space');\n        // }\n        horizontalPadding += (availableMeasureSpace - measuresPerRow * measureWidth) / 2; //update horizontal padding to center rows\n\n        //calculate the number of rows\n        //let ticksPerMeasure = midi.header.ppq*beatsPerMeasure; //needs to take into account size of a beat\n        // let beatsPerRow = beatsPerMeasure * measuresPerRow;\n        let measureNumber = score.tracks.reduce((accum, track) => Math.max(accum, track.measures.length), 0);\n        if (measureNumber <= 0) {\n            throw new Error('Failed to identify number of measures');\n        }\n        let rowNumber = Math.ceil(measureNumber / measuresPerRow);\n\n        //calculate required height (vert padding + row height + row padding)\n        // let height = verticalPadding * 2 + rowNumber * (rowHeight + measureLabelSpace) + (rowNumber - 1) * rowPadding;\n\n        let getCurrentSignatures = (measureNumber: number) => {\n            let timeSignatures = [...score!.tracks[0].timeSignatures].reverse(); // we reverse the array because we want to find the latest key signature.\n            let keySignatures = [...score!.tracks[0].keySignatures].reverse();\n\n            let currentTime = timeSignatures.find(timeSignature => timeSignature.measure <= measureNumber)!;\n            let currentKey = keySignatures.find(keySignature => keySignature.measure <= measureNumber);\n\n            if (!currentTime) currentTime = score!.tracks[0].timeSignatures[0]; // sometimes, signatures are defined on the second measure which results in find failure above. This line adds error handling for this.\n            if (!keySignatures) currentKey = score!.tracks[0].keySignatures[0];\n\n            return {currentTime, currentKey};\n        }\n\n        let measure = (x: number, y: number, measureNumber: number) => {\n            // Get time signature of current measure\n            let {currentTime, currentKey} = getCurrentSignatures(measureNumber);\n            beatWidth = scoreWidth / currentTime.beats / measuresPerRow;\n            beatsPerMeasure = currentTime.beats;\n            keyFifths = currentKey!.fifths;\n\n            // Draw measure\n            let key = 0;\n            let measureSVG: JSX.Element[] = [];\n            measureSVG.push(<rect key={key++} x={measureWidth - strokeWidth / 2} y={measureLabelSpace - strokeWidth / 2} width={strokeWidth} height={rowHeight + strokeWidth} fill=\"#000000\" />);\n            for (let j = minLine; j <= maxLine; j++) {\n                let octaveLine = octaveLines[j % 7];\n                if (octaveLine !== undefined) {\n                    let lineY = measureLabelSpace + rowHeight - (j - minLine) * noteSymbolSize / 2;\n                    measureSVG.push(<rect key={key++} x={strokeWidth / 2} y={lineY - strokeWidth / 2} width={measureWidth - strokeWidth} height={strokeWidth} fill={octaveLine.color} />);\n                    if (measureNumber % measuresPerRow === 0 && octaveLine.number === true) {\n                        measureSVG.push(<text x={-strokeWidth} key={key++} y={lineY} fontSize={measureLabelSpace} textAnchor=\"end\" dominantBaseline=\"middle\">{Math.floor(j / 7)}</text>);\n                    }\n                    if (j < maxLine) {\n                        for (let measureNumber = 1; measureNumber < beatsPerMeasure; measureNumber++) {\n                            let tickX = measureWidth / beatsPerMeasure * measureNumber;\n                            measureSVG.push(<rect key={key++} x={tickX - strokeWidth / 2} y={lineY - tickSize} width={strokeWidth} height={tickSize - strokeWidth / 2} fill=\"#000000\" />);\n                        }\n                    }\n                }\n            }\n\n            // Add notes to the measure\n            const noteHeadSVG: JSX.Element[] = [];\n            const noteTailSVG: JSX.Element[] = [];\n            score!.tracks.forEach(track => {\n                track.measures[measureNumber].forEach((note, idx) => {\n                    noteHeadSVG.push(noteHead(note, key++));\n                    let tieStart = note.attributes.ties.includes(Tie.Start);\n                    let tieStop = note.attributes.ties.includes(Tie.Stop);\n                    // check if the note is a tied note that continues to next row\n                    let noteSpansRow = tieStart /*&& (idx === track.measures[measureNumber].length - 1)*/ && (measureNumber % measuresPerRow === measuresPerRow - 1);\n                    noteTailSVG.push(noteTail(note, key++, tieStart, tieStop, noteSpansRow));\n                });\n            });\n\n            return (\n                <g id={`measure${measureNumber + 1}`} key={measureNumber} transform={`translate(${x}, ${y})`}>\n                    <g id='frame'>\n                        {devMode ? <rect width={measureWidth} height={measureLabelSpace - strokeWidth / 2} fill=\"#ffdddd\" /> : null}\n                        <text x={strokeWidth} y={measureLabelSpace - strokeWidth} fontSize={measureLabelSpace}>{measureNumber + 1}</text>\n                        {measureSVG}\n                    </g>\n                    <g id='notes'>\n                        {noteTailSVG}\n                        {noteHeadSVG}\n                    </g>\n                </g>\n            );\n        }\n\n        let row = (i: number): JSX.Element => {\n            let height = (rowHeight + measureLabelSpace) + noteSymbolSize / 2;\n            return (\n                <div className={`snview-row snview-row-${i+1}`} key={i} style={{position: 'relative', height: 'auto', paddingBottom: `${rowPadding}px`}}>\n                    <svg viewBox={`0 0 ${width} ${height}`}>\n                        <g id={`row${i}`} key={i} transform={`translate(${horizontalPadding}, 0)`}>\n                            {devMode ? <rect y={measureLabelSpace} width={staffLabelSpace} height={rowHeight} fill=\"#ffdddd\" /> : null}\n                            {devMode ? <rect x={staffLabelSpace} y={measureLabelSpace} width={octaveLabelSpace} height={rowHeight} fill=\"#ffddff\" /> : null}\n                            <text x={staffLabelSpace} y={measureLabelSpace + rowHeight / 2} fontSize={staffLabelSpace * 1.5} textAnchor=\"end\" dominantBaseline=\"middle\">𝒯</text>\n                            <rect x={staffLabelSpace + octaveLabelSpace - strokeWidth / 2} y={measureLabelSpace - strokeWidth / 2} width={strokeWidth} height={rowHeight + strokeWidth} fill=\"#000000\" />\n\n                            {range(0, i < rowNumber - 1 ? measuresPerRow : measureNumber - (rowNumber - 1) * measuresPerRow).map(j =>\n                                measure(staffLabelSpace + octaveLabelSpace + j * measureWidth, 0, i * measuresPerRow + j)\n                            )}\n                        </g>\n                    </svg>\n                </div>\n            );\n        }\n\n        let noteTimeToPos = (noteTime: number) => ({\n            x: beatWidth * noteTime,\n            y: rowHeight + measureLabelSpace\n        })\n\n        // let beatsToPos = (beat: number) => {\n        //     let row = Math.floor(beat / beatsPerRow);\n        //     let measure = (beat - row * beatsPerRow) / beatsPerMeasure;\n        //     return {\n        //         row, measure,\n        //         ...rowMeasureToPos(row, measure)\n        //     };\n        // }\n        // let rowMeasureToPos = (row: number, measure: number) => ({\n        //     x: horizontalPadding + staffLabelSpace + octaveLabelSpace + measure * measureWidth,\n        //     y: verticalPadding + row * (rowHeight + measureLabelSpace + rowPadding) + rowHeight + measureLabelSpace\n        // });\n\n        let noteTail = (note: basicNote, i: number, tieStart: boolean, tieStop: boolean, noteSpansRow: boolean) => {\n            let key = 0;\n            let boxes: JSX.Element[] = [];\n\n            let line = getNoteLine(note.midi) - minLine;\n            let {x: xStart, y: yStart} = noteTimeToPos(note.time);\n            let {x: xEnd} = noteTimeToPos(note.time + note.duration);\n\n            // let pushBox = (x1: number, x2: number, y: number) => {\n            //     boxes.push(<rect key={key++} x={x1} y={y - (line + 1) * noteSymbolSize / 2} width={x2 - x1} height={noteSymbolSize} fill={colorPreferenceStyles[noteDurationColor]} fillOpacity={.5} />);\n            // }\n            // while (rowStart < rowEnd) {\n            //     //only executes rarely so it is faster to compute this value in the loop\n            //     pushBox(xStart, horizontalPadding + staffLabelSpace + octaveLabelSpace + measuresPerRow * measureWidth, yStart);\n            //     rowStart++;\n            //     measureStart = 0;\n            //     let {x, y} = rowMeasureToPos(rowStart, measureStart);\n            //     xStart = x;\n            //     yStart = y;\n            // }\n\n            let roundingSpace = Math.max(Math.min(noteSymbolSize, xEnd-xStart),0);\n            let radiusStart = roundingSpace/4;\n            let radiusEnd = roundingSpace/2;\n            let pointedEnd = noteSpansRow;\n            \n            if(tieStart){\n                //if(!noteSpansRow){ //this check prevents pointed ends from extending past the end of the row\n                    radiusEnd = 0;\n                //}\n            }\n            if(tieStop){\n                radiusStart = 0;\n            }\n            boxes.push(\n                <path\n                    key={key++}\n                    d={`\n                        M${xStart+radiusStart} ${yStart - (line + 1) * noteSymbolSize / 2}\n                        H${xEnd - radiusEnd}\n                        ${pointedEnd?`l`:`a${radiusEnd} ${radiusEnd} 0 0 ${noteSpansRow?0:1} `}${radiusEnd} ${radiusEnd}\n                        ${pointedEnd?`\n                            l${noteSymbolSize/2 - radiusEnd} ${noteSymbolSize/2 - radiusEnd}\n                            l${-noteSymbolSize/2 + radiusEnd} ${noteSymbolSize/2 - radiusEnd}\n                        `:`v${noteSymbolSize - 2 * radiusEnd}`}\n                        ${pointedEnd?`l`:`a${radiusEnd} ${radiusEnd} 0 0 ${noteSpansRow?0:1} `}${-radiusEnd} ${radiusEnd}\n                        H${xStart + radiusStart}\n                        a${radiusStart} ${radiusStart} 0 0 1 ${-radiusStart} ${-radiusStart}\n                        v${-noteSymbolSize + 2 * radiusStart}\n                        a${radiusStart} ${radiusStart} 0 0 1 ${radiusStart} ${-radiusStart}\n                        z\n                    `}\n                    fill={colorPreferenceStyles[noteDurationColor]}\n                    fillOpacity={0.5}\n                />\n            );\n\n            return (\n                <React.Fragment key={i}>\n                    {boxes}\n                </React.Fragment>\n            );\n        }\n\n        let noteHead = (note: basicNote, i: number) => {\n            if (note.attributes.ties.includes(Tie.Stop))\n                return;\n            let accidental: Accidental = getNoteAccidental(note.midi);\n            let line = getNoteLine(note.midi) - minLine;\n\n            let {x, y} = noteTimeToPos(note.time);\n\n            x += noteSymbolSize / 2;\n            y -= line * noteSymbolSize / 2;\n            let triHeight = noteSymbolSize * Math.sqrt(3) / 2;\n\n            let strokeWidth = 3;\n            let crossCircleWidth = noteSymbolSize / 2 / Math.sqrt(2);\n\n            let triangleUp = <polygon key={i} points={`${x},${y - triHeight / 2} ${x + noteSymbolSize / 2},${y + triHeight / 2} ${x - noteSymbolSize / 2},${y + triHeight / 2}`} fill={colorPreferenceStyles[noteSymbolColor]} />;\n            let triangleDown = <polygon key={i} points={`${x},${y + triHeight / 2} ${x + noteSymbolSize / 2},${y - triHeight / 2} ${x - noteSymbolSize / 2},${y - triHeight / 2}`} fill={colorPreferenceStyles[noteSymbolColor]} />;\n            let hollowCircle = <circle key={i} cx={x} cy={y} r={(noteSymbolSize - strokeWidth) / 2} strokeWidth={strokeWidth} stroke={colorPreferenceStyles[noteSymbolColor]} fill='none' />;\n            let circle = <circle key={i} cx={x} cy={y} r={noteSymbolSize / 2} fill={colorPreferenceStyles[noteSymbolColor]} />;\n\n            let crossCircle = <g key={i}>\n                <circle cx={x} cy={y} r={(noteSymbolSize - 2) / 2} strokeWidth={2} stroke={colorPreferenceStyles[noteSymbolColor]} fill='none' />;\n                <line x1={x - crossCircleWidth} y1={y - crossCircleWidth} x2={x + crossCircleWidth} y2={y + crossCircleWidth} stroke={colorPreferenceStyles[noteSymbolColor]} strokeWidth={2} />\n                <line x1={x - crossCircleWidth} y1={y + crossCircleWidth} x2={x + crossCircleWidth} y2={y - crossCircleWidth} stroke={colorPreferenceStyles[noteSymbolColor]} strokeWidth={2} />\n            </g>\n\n            let square = <rect x={x - noteSymbolSize / 2 + strokeWidth / 2} y={y - noteSymbolSize / 2 + strokeWidth / 2} width={noteSymbolSize - strokeWidth} height={noteSymbolSize - strokeWidth} fill={colorPreferenceStyles[noteSymbolColor]} />\n            let hollowSquare = <rect x={x - noteSymbolSize / 2 + strokeWidth / 2} y={y - noteSymbolSize / 2 + strokeWidth / 2} width={noteSymbolSize - strokeWidth} height={noteSymbolSize - strokeWidth} stroke={colorPreferenceStyles[noteSymbolColor]} strokeWidth={strokeWidth} fill='none' />\n\n            let noteShapes = {\n                '▲': triangleUp,\n                '▼': triangleDown,\n                '○': hollowCircle,\n                '●': circle,\n                '◼': square,\n                '□': hollowSquare,\n                '⨂': crossCircle,\n            } as any;\n\n            if (accidental === 0) return noteShapes[naturalNoteShape];\n            else if (accidentalType === 'auto') return accidental > 0 ? noteShapes[sharpNoteShape] : noteShapes[flatNoteShape];\n            else return accidentalType === 'sharp' ? noteShapes[sharpNoteShape] : noteShapes[flatNoteShape];\n        }\n\n        // let devSvg = devMode ? (\n        //     <g id=\"devMode\">\n        //         {<rect x={0} y={0} width={width} height={height} fill=\"#ddddff\" />}\n        //         {<circle cx={0} cy={0} r=\"40\" stroke=\"black\" strokeWidth=\"3\" fill=\"red\" />}\n        //         {<circle cx={width} cy={0} r=\"40\" stroke=\"black\" strokeWidth=\"3\" fill=\"red\" />}\n        //         {<circle cx={width} cy={`${height}`} r=\"40\" stroke=\"black\" strokeWidth=\"3\" fill=\"red\" />}\n        //         {<circle cx={0} cy={height} r=\"40\" stroke=\"black\" strokeWidth=\"3\" fill=\"red\" />}\n        //         {<rect x={horizontalPadding} y={verticalPadding} width={width - horizontalPadding * 2} height={height - verticalPadding * 2} fill=\"#ddffdd\" />}\n        //     </g>\n        // ) : null;\n\n        let svgRows: JSX.Element[] = range(0, rowNumber).map(i => row(i));\n        return (\n            <div id=\"snview\" ref={ref} style={{width: '100%', height: 'auto', overflow: 'hidden', minWidth: '350px', userSelect: 'text', paddingTop: verticalPadding, paddingBottom: verticalPadding}}>\n                {/*devSvg*/}\n                <div className={`snview-row snview-row-0`} style={{position: 'relative', height: 'auto', paddingBottom: `${rowPadding}px`}}>\n                    <svg viewBox={`0 0 ${width} ${180}`}>\n                        <text x={width/2} y={50} fontSize={40} textAnchor=\"middle\" alignmentBaseline=\"hanging\">{title}</text>\n                        <text x={70} y={170} fontSize={25} textAnchor=\"start\">60 bpm</text>\n                        <text x={width-70} y={170} fontSize={25} textAnchor=\"end\">{author}</text>\n                    </svg>\n                </div>\n                {svgRows}\n            </div>\n        );\n    } catch (e) {\n        if (!dialogState.shown) {\n            showError('An issue was encountered while generating WYSIWYP output for the selected file.');\n        }\n        //console.error(e);\n        return <div ref={ref}></div>;\n    }\n};\n\nexport default SNView;\n","\nexport function range(min: number, max: number){\n    let res: number[] = [];\n    for(let i = min; i < max; i++){\n        res.push(i);\n    }\n    return res;\n}\n","import MusicXML from 'musicxml-interfaces';\nimport {basicNote, TimeSignature, KeySignature, Tracks, Score, Tie, measure} from './Types'\n\nconst pitchToMidi = (pitch: {octave: number, step: string, alter?: number}) => {\n    // we assume C4 = 60 as middle C. Note that typical 88-key piano contains notes from A0 (21) - C8 (108).\n    let step = ({c: 0, d: 2, e: 4, f: 5, g: 7, a: 9, b: 11} as {[index: string]: number})[pitch.step.toLowerCase()];\n    return (pitch.octave + 1) * 12 + step + (pitch.alter === undefined ? 0 : Math.round(pitch.alter));\n};\n\nexport const parse = (xml: MusicXML.ScoreTimewise): Score => {\n    let currentBeatType = 4;\n    let parts: {\n        [index: string]: {\n            divisions: number,\n            progress: number,\n            timeSignatures: TimeSignature[];\n            keySignatures: KeySignature[];\n            measures: measure[],\n        }\n    } = {};\n    xml.measures.forEach((measure, measureNumber) => {\n        Object.keys(measure.parts).forEach(partName => {\n            if (parts[partName] === undefined) {\n                parts[partName] = {\n                    divisions: undefined!,\n                    progress: 0,\n                    timeSignatures: [],\n                    keySignatures: [],\n                    measures: Array(xml.measures.length)\n                };\n            }\n            let part = parts[partName];\n            let notes: basicNote[] = [];\n            // computes note lengh with respect to the beat type\n            let divisionsToNoteLength = (divisions: number) => {\n                if (part.divisions === undefined) {\n                    console.error('A note was defined before timing information was established');\n                    return divisions / 24;\n                }\n                return divisions / part.divisions * (currentBeatType / 4);\n            }\n            part.progress = 0;\n            measure.parts[partName].forEach(entry => {\n                switch (entry._class) {\n                    case 'Note':\n                        if (entry.duration !== undefined) { //grace notes do not have a duration - are not displayed\n                            let time = part.progress;\n                            if (entry.chord !== undefined) {\n                                if (notes.length === 0) {\n                                    console.error('The first note within a measure was marked as being part of a chord');\n                                } else {\n                                    if (notes[notes.length - 1].duration !== divisionsToNoteLength(entry.duration)) {\n                                        console.error('Two notes in a chord were of different durations');\n                                    }\n                                    time = notes[notes.length - 1].time;\n                                }\n                            } else {\n                                part.progress += divisionsToNoteLength(entry.duration);\n                            }\n                            if (entry.rest === undefined && entry.pitch === undefined) {\n                                console.error('A note was neither marked as a rest or given a pitch');\n                            }\n                            if (entry.rest !== undefined && entry.pitch !== undefined) {\n                                console.error('A note was marked as a rest but was also given a pitch');\n                            }\n                            if (entry.pitch !== undefined) {\n                                const entryTies = entry.ties as {type: number}[];\n                                notes.push({\n                                    time, duration: divisionsToNoteLength(entry.duration),\n                                    midi: pitchToMidi(entry.pitch),\n                                    attributes: {\n                                        ties: entryTies ? entryTies.map(tie => tie.type === 0 ? Tie.Start : Tie.Stop) : []\n                                    }\n                                });\n                            }\n                            part.measures[measureNumber] = notes;\n                        }\n                        break;\n                    case 'Backup':\n                        part.progress -= divisionsToNoteLength(entry.duration);\n                        break;\n                    case 'Forward':\n                        part.progress += divisionsToNoteLength(entry.duration);\n                        break;\n                    case 'Attributes':\n                        if (entry.divisions !== undefined) {\n                            part.divisions = entry.divisions;\n                        }\n                        if (entry.times !== undefined) {\n                            if (entry.times.length !== 0) {\n                                try {\n                                    part.timeSignatures.push({\n                                        measure: measureNumber,\n                                        beats: parseInt(entry.times[0].beats[0]),\n                                        beatTypes: entry.times[0].beatTypes[0],\n                                    });\n                                    currentBeatType = entry.times[0].beatTypes[0];\n                                } catch (e) {\n                                    console.error('Failed to parse time signature', entry.times[0]);\n                                }\n                            }\n                        }\n                        if (entry.keySignatures && entry.keySignatures.length !== 0) {\n                            try {\n                                part.keySignatures.push({\n                                    measure: measureNumber,\n                                    fifths: entry.keySignatures[0].fifths\n                                });\n                            } catch (e) {\n                                console.error('Failed to parse key signature', entry.keySignatures[0]);\n                            }\n                        }\n                        break;\n                    case 'Print':\n                        break;\n                    case 'Barline':\n                        break;\n                    case 'Direction':\n                        break;\n                    default:\n                        console.error(`Unrecognized MusicXML entry: '${entry._class}'`);\n                        break;\n                }\n            });\n        });\n    });\n    let tracks: Tracks = Object.keys(parts).map(x => ({\n        measures: parts[x].measures,\n        timeSignatures: parts[x].timeSignatures,\n        keySignatures: parts[x].keySignatures\n    }));\n\n    // TODO: more error checking\n    // handle unprovided signatures\n    tracks.forEach(track => {\n        // add default values for key signatures if it is not provided.\n        if (track.keySignatures.length === 0) track.keySignatures.push({measure: 0, fifths: 0});\n        // handling unprovided time signatures requires extra care. We go through each measure and assign appropriate beatTypes for each measure.\n        if (track.timeSignatures.length === 0) {\n            if (track.measures.length === 1) {\n                // case 1: all notes grouped into a single measure\n                let measure = track.measures[0];\n                let newMeasures: basicNote[][] = Array(Math.ceil(measure.length / 4)).fill([]).map((_, index) => index * 4).map(start => measure.slice(start, start + 4)); // divide notes into chunks of four\n                newMeasures.forEach((measure, idx) => measure.forEach(note => note.time -= 4 * idx)); // shift note start time appropriately\n                track.timeSignatures.push({measure: newMeasures.length, beats: 4, beatTypes: 4})\n                track.measures = newMeasures;\n            } else {\n                // case 2: time signature is just not provided\n                let currentMeasureLength = 4; // start with assuming 4/4 time signature.\n                track.measures.forEach((measure, measureNumber) => {\n                    let lastNote = measure[measure.length - 1];\n                    let measureLength = Math.max(lastNote.time + lastNote.duration);\n                    if (currentMeasureLength !== measureLength) {\n                        track.timeSignatures.push({measure: measureNumber, beats: measureLength, beatTypes: 4});\n                        currentMeasureLength = measureLength;\n                    }\n                });\n            }\n        }\n    });\n    return {tracks}\n};","module.exports = __webpack_public_path__ + \"static/media/dropDown.2ec80983.svg\";","module.exports = __webpack_public_path__ + \"static/media/upload.027829c2.svg\";"],"sourceRoot":""}